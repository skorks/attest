#!/usr/bin/env ruby

#need this so that bundler doesn't throw an error after library has been installed as gem and the executable is called
ENV["BUNDLE_GEMFILE"] = File.expand_path(File.dirname(__FILE__) + "/../Gemfile")
ENV["attest"] = "true"

require File.expand_path(File.dirname(__FILE__) + "/../lib/attest")

opts = Trollop::options do
  banner <<-EOS
Usage:
       attest [options] <filenames>+
where [options] are:
EOS

  opt :file, "Ruby file with inline tests that should be executed",
        :type => String
end
Trollop::die :file, "Must exist" unless File.exist?(opts[:file]) if opts[:file]

Attest.configure do |config|
  config.output_writer = Attest::Output::BasicOutputWriter.new
end

a = load opts[:file]
